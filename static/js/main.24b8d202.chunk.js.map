{"version":3,"sources":["editor/plugins/CmdKeyPlugins.js","editor/plugins/CtrlKeyPlugins.js","editor/plugins/HighlightFocusedBlockPlugin.js","editor/api/SuggestionMapAPI.js","editor/plugins/LastWordPlugin.js","editor/plugins/SuggestionPortalPlugin.js","editor/plugins/ToolbarPlugin.js","editor/plugins/styleQueryPlugin.js","editor/plugins/TextCountPlugin.js","editor/plugins/EditorStylePlugin.js","editor/api/EditorContentAPI.js","editor/Editor.js","editor/plugins/TabIndentPlugin.js","editor/KeyMapTable.js","App.js","serviceWorker.js","index.js"],"names":["CmdKeyMark","options","type","key","onKeyDown","e","editor","next","metaKey","preventDefault","toggleMark","RenderMark","renderMark","props","mark","component","CmdMarkPlugin","CmdKeyPlugins","attribute","children","style","background","CtrlKeyBlock","ctrlKey","isType","value","blocks","some","block","setBlocks","RenderBlock","renderBlock","node","ctrlKeyPlugin","CtrlKeyPlugins","HighlightFocusedBlockPlugin","backgroundColor","isFocused","store","get","data","set","suggestionMap","SuggestionMapAPI","optionStyle","select","firstChild","lastChild","Object","assign","color","padding","fontWeight","border","cursor","borderTop","borderBottom","suggestionList","clear","Portal","React","useState","open","setOpen","index","setIndex","xOffset","setXOffset","yOffset","setYOffset","portalRef","useRef","useEffect","editorEventHandler","detail","instruction","rect","window","getSelection","getRangeAt","getBoundingClientRect","left","bottom","console","log","updatePortalPosition","newIndex","length","current","scrollIntoView","inline","replaceLastWord","insertText","handleEditor","updateHandler","updateSuggestionMap","document","addEventListener","removeEventListener","onMouseDown","onMouseOver","ref","display","flexFlow","overflow","maxHeight","minWidth","position","top","transform","map","option","i","SuggestionPortalPlugin","queries","getLastWord","focusText","text","focusOffset","selection","focus","offset","slice","split","join","reverse","getSuggestionWord","getSuggestionWordOf","getSuggestionListOf","lastWord","reduce","acc","char","commands","newWord","deleteBackward","replaceLastWordBySuggestion","suggestion","editorEmittedEvent","CustomEvent","keyCode","dispatchEvent","EventDispatcher","renderEditor","toolbarStyle","justifyContent","moduleStyle","buttonStyle","active","margin","fontFamily","makeButton","mouseDownHandler","styleHandler","label","ToggleMarkButton","isMarkTypeActive","makeToggleMarkButton","SetBlockButton","isBlockTypeActive","makeSetBlockButton","Toolbar","ToolbarPlugin","isBoldActive","activeMarks","isItalicActive","isStrikethroughActive","isCodeBlock","isParagraphBlock","isQuotationBlock","textAlign","calLength","str","TextCountPlugin","totalText","selectedText","fragment","EditorStylePlugin","storedJsonStr","json","JSON","parse","Value","fromJSON","nodes","object","change","jsonStr","stringify","toJSON","plugins","H2oEditor","initVal","EditorContentAPI","setValue","onChange","autoFocus","tableStyle","pairStyle","inputStyle","width","outline","deleteButtonStyle","Input","setState","v","setV","inputRef","target","onFocus","onBlur","KeyMapTable","table","setKeys","keys","setVals","setUids","setNextId","vals","uids","nextId","setStateBy","field","setter","newVal","exportData","bind","onClick","uid","App","Editor","Divider","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.24b8d202.chunk.js","sourcesContent":["import React from 'react'\n\nconst CmdKeyMark = options => {\n  const { type, key } = options\n  return {\n    onKeyDown: (e, editor, next) => {\n      if (!e.metaKey || !(e.key === key)) {\n        return next()\n      }\n      e.preventDefault()\n      editor.toggleMark(type)\n    }\n  }\n}\nconst RenderMark = options => {\n  return {\n    renderMark: (props, editor, next) => {\n      if (props.mark.type === options.type) {\n        return options.component(props)\n      } else {\n        return next()\n      }\n    }\n  }\n}\nconst CmdMarkPlugin = options => [\n  CmdKeyMark(options),\n  RenderMark(options)\n]\n\nconst CmdKeyPlugins = [\n  ...CmdMarkPlugin({\n    type: 'bold',\n    key: 'b',\n    component: props => (\n      <strong {...props.attribute}>{props.children}</strong>\n    )\n  }),\n  ...CmdMarkPlugin({\n    type: 'strikethrough',\n    key: 's',\n    component: props => (\n      <s {...props.attribute}>{props.children}</s>\n    )\n  }),\n  ...CmdMarkPlugin({\n    type: 'underline',\n    key: 'u',\n    component: props => (\n      <u {...props.attribute}>{props.children}</u>\n    )\n  }),\n  ...CmdMarkPlugin({\n    type: 'italic',\n    key: 'i',\n    component: props => (\n      <i {...props.attribute}>{props.children}</i>\n    )\n  }),\n  ...CmdMarkPlugin({\n    type: 'highlight',\n    key: 'h',\n    component: props => (\n      <span {...props.attribute} style={{ background: 'gold' }}>{props.children}</span>\n    )\n  })\n]\n\nexport default CmdKeyPlugins\n","import React from 'react'\n\nconst CtrlKeyBlock = options => {\n  const { type, key } = options\n  return {\n    onKeyDown: (e, editor, next) => {\n      if (!e.ctrlKey || !(e.key === key)) {\n        return next()\n      }\n      e.preventDefault()\n      const isType = editor.value.blocks.some(block => block.type === type)\n      editor.setBlocks({ type: isType ? 'paragraph' : type })\n    }\n  }\n}\n\nconst RenderBlock = options => {\n  const { type, component } = options\n  return {\n    renderBlock: (props, editor, next) => {\n      if (props.node.type === type) {\n        return component({ ...props })\n      } else {\n        return next()\n      }\n    }\n  }\n}\nconst ctrlKeyPlugin = ({ type, key, component }) => {\n  return [\n    CtrlKeyBlock({ type, key }),\n    RenderBlock({ type, component })\n  ]\n}\n\nconst CtrlKeyPlugins = [\n  ...ctrlKeyPlugin({\n    type: 'code',\n    key: 'c',\n    component: props => (\n      <pre {...props.attribute}>\n        <code>{props.children}</code>\n      </pre>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header1',\n    key: '1',\n    component: props => (\n      <h1 {...props.attribute}>\n        {props.children}\n      </h1>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header2',\n    key: '2',\n    component: props => (\n      <h2 {...props.attribute}>\n        {props.children}\n      </h2>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header3',\n    key: '3',\n    component: props => (\n      <h3 {...props.attribute}>\n        {props.children}\n      </h3>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header4',\n    key: '4',\n    component: props => (\n      <h4 {...props.attribute}>\n        {props.children}\n      </h4>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header5',\n    key: '5',\n    component: props => (\n      <h5 {...props.attribute}>\n        {props.children}\n      </h5>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'header6',\n    key: '6',\n    component: props => (\n      <h6 {...props.attribute}>\n        {props.children}\n      </h6>\n    )\n  }),\n  ...ctrlKeyPlugin({\n    type: 'quotation',\n    key: 'q',\n    component: props => (\n      <blockquote {...props.attribute}>\n        {props.children}\n      </blockquote>\n    )\n  })\n]\n\nexport default CtrlKeyPlugins\n","import React from 'react'\n\nconst HighlightFocusedBlockPlugin = backgroundColor => (\n  {\n    renderBlock: (props, editor, next) => {\n      return props.isFocused ? (\n        <div style={{ backgroundColor }}>\n          {next()}\n        </div>) : next()\n    }\n  }\n)\nexport default HighlightFocusedBlockPlugin\n","import store from 'store-js'\n\nconst exporter = data => { store.set('client-suggestionMap', data) }\nconst importer = () => store.get('client-suggestionMap') || {}\n\nexport default { importer, exporter }\n","import SuggestionMapAPI from '../api/SuggestionMapAPI'\nlet suggestionMap = SuggestionMapAPI.importer()\n\nconst LastWordPlugin = {\n  queries: {\n    getLastWord: editor => {\n      if (editor.value.focusText) {\n        const text = editor.value.focusText.text\n        const focusOffset = editor.value.selection.focus.offset\n        const tail = text.slice(0, focusOffset).split('\\n').join('').split(' ').reverse()[0]\n        return tail\n      }\n      return ''\n    },\n    getSuggestionWord: editor => { // string\n      return suggestionMap[editor.getLastWord()] || ''\n    },\n    getSuggestionWordOf: (editor, key) => { // string\n      return suggestionMap[editor.getLastWord() + key] || ''\n    },\n    getSuggestionListOf: (editor, key) => {\n      const lastWord = editor.getLastWord() + key || ''\n      return !lastWord ? [] : lastWord.split('').reduce(\n        (acc, char, i) => (\n          acc[0] ? [acc[0] + char, ...acc] : [char]\n        ), []\n      ).reduce(\n        (acc, key) => (\n          suggestionMap[key] ? [...acc, suggestionMap[key]] : [...acc]\n        ), []\n      )\n    }\n  },\n  commands: {\n    updateSuggestionMap: editor => { suggestionMap = SuggestionMapAPI.importer() },\n    replaceLastWord: (editor, newWord) => {\n      const lastWord = editor.getLastWord()\n      if (!lastWord) {\n        return\n      }\n      if (typeof newWord !== 'string') {\n        return\n      }\n      editor.deleteBackward(lastWord.length).insertText(newWord)\n    },\n    replaceLastWordBySuggestion: editor => {\n      const lastWord = editor.getLastWord()\n      if (!lastWord) {\n        return\n      }\n      const suggestion = editor.getSuggestionWord()\n      if (!suggestion) {\n        return\n      }\n      editor.deleteBackward(lastWord.length).insertText(suggestion)\n    }\n  }\n}\n\nexport default LastWordPlugin\n","import React from 'react'\nimport LastWordPlugin from './LastWordPlugin'\n\nconst portalStyle = ({ open, xOffset, yOffset }) => ({\n  display: open ? 'flex' : 'none',\n  flexFlow: 'column',\n  overflow: 'scroll',\n  maxHeight: '136px',\n  minWidth: '100px',\n\n  position: 'fixed',\n  left: xOffset,\n  top: yOffset,\n  transform: 'translate3d(-5px,5px,0)',\n\n  border: '1px dashed gray'\n})\n\nconst optionStyle = ({ select, firstChild, lastChild }) => {\n  const baseStyle = {\n    backgroundColor: 'white',\n    color: 'gray',\n    padding: '7px 14px 7px 7px',\n    fontWeight: 'bold',\n    border: '1px solid transparent',\n    cursor: 'pointer'\n  }\n  const selectStyle = {\n    backgroundColor: 'gray',\n    color: 'white',\n    borderTop: '1px dashed white',\n    borderBottom: '1px dashed white'\n  }\n  const lastStyle = {\n    borderBottom: '1px solid transparent'\n  }\n  const firstStyle = {\n    borderTop: '1px solid transparent'\n  }\n  return Object.assign(\n    {},\n    baseStyle,\n    select ? selectStyle : {},\n    firstChild ? firstStyle : {},\n    lastChild ? lastStyle : {}\n  )\n}\n\n// sharing data between Portal and EventDispatcher\nconst suggestionList = {\n  value: [],\n  clear: () => { suggestionList.value = [] }\n}\n\nconst Portal = ({ editor }) => {\n  // portal state, listen to editor\n  const [open, setOpen] = React.useState(false)\n  const [index, setIndex] = React.useState(0)\n\n  // portal position\n  const [xOffset, setXOffset] = React.useState(0)\n  const [yOffset, setYOffset] = React.useState(0)\n  const portalRef = React.useRef(null)\n\n  const updatePortalPosition = () => {\n    try {\n      const rect = window.getSelection().getRangeAt(0).getBoundingClientRect()\n      setXOffset(rect.left)\n      setYOffset(rect.bottom)\n    } catch {\n      console.log('uncaught caret position')\n    }\n  }\n\n  React.useEffect(\n    () => {\n      const handleEditor = ({ editor, index }) => e => {\n        switch (e.detail.instruction) {\n          case 'open': {\n            updatePortalPosition()\n            setIndex(0)\n            setOpen(true)\n            break\n          }\n          case 'close': {\n            setOpen(false)\n            setIndex(0)\n            break\n          }\n          case 'incre': {\n            const newIndex = (index + 1) % suggestionList.value.length || 0\n            setIndex(newIndex)\n            portalRef.current && portalRef.current.children[newIndex].scrollIntoView({\n              block: 'nearest',\n              inline: 'nearest'\n            })\n            break\n          }\n          case 'decre': {\n            const newIndex = (index - 1 + suggestionList.value.length) % suggestionList.value.length || 0\n            setIndex(newIndex)\n            portalRef.current && portalRef.current.children[newIndex].scrollIntoView({\n              block: 'nearest',\n              inline: 'nearest'\n            })\n            break\n          }\n          case 'enter': {\n            const suggestion = suggestionList.value[index]\n            if (suggestion) {\n              editor.replaceLastWord(suggestionList.value[index]).insertText(' ')\n            }\n            setIndex(0)\n            setOpen(false)\n            break\n          }\n          default: {\n            console.log('unhandled event:', e)\n            break\n          }\n        }\n      }\n      const editorEventHandler = handleEditor({ index, editor })\n      const updateHandler = () => editor.updateSuggestionMap()\n      document.addEventListener('editorEmittedEvent', editorEventHandler)\n      document.addEventListener('suggestionMapUpdated', updateHandler)\n      return () => {\n        document.removeEventListener('editorEmittedEvent', editorEventHandler)\n        document.removeEventListener('suggestionMapUpdated', updateHandler)\n      }\n    }, [editor, index] // update callback behavior when index or editor change\n  )\n\n  const onMouseDown = index => e => {\n    e.preventDefault()\n    setIndex(index)\n    setOpen(false)\n    editor.replaceLastWord(suggestionList.value[index])\n  }\n  const onMouseOver = index => e => {\n    e.preventDefault()\n    setIndex(index)\n  }\n\n  return (\n    suggestionList.value.length\n      ? (\n        <div\n          ref={portalRef}\n          style={portalStyle({\n            open,\n            xOffset,\n            yOffset\n          })}\n        >\n          {\n            suggestionList.value.map(\n              (option, i) => (\n                <div\n                  key={i}\n                  onMouseOver={onMouseOver(i)}\n                  onMouseDown={onMouseDown(i)}\n                  style={optionStyle({\n                    select: index === i,\n                    firstChild: i === 0,\n                    lastChild: i === suggestionList.value.length - 1\n                  })}\n                >\n                  {option}\n                </div>\n              )\n            )\n          }\n        </div>\n      )\n      : null\n  )\n}\n\nconst EventDispatcher = () => {\n  const editorEmittedEvent = instruction => (\n    new window.CustomEvent('editorEmittedEvent', { detail: { instruction } })\n  )\n\n  const onKeyDown = (e, editor, next) => {\n    if (e.keyCode >= 65 && e.keyCode <= 90 && !e.ctrlKey && !e.metaKey) {\n    // a-65 z-90\n      suggestionList.value = editor.getSuggestionListOf(e.key)\n      document.dispatchEvent(editorEmittedEvent('open'))\n      return next()\n    } else if (suggestionList.value.length) {\n      switch (e.keyCode) {\n        case 38: { // up\n          e.preventDefault()\n          document.dispatchEvent(editorEmittedEvent('decre'))\n          return\n        }\n        case 40: { // down\n          e.preventDefault()\n          document.dispatchEvent(editorEmittedEvent('incre'))\n          return\n        }\n        case 13: { // enter\n          e.preventDefault()\n          document.dispatchEvent(editorEmittedEvent('enter'))\n          suggestionList.clear()\n          return\n        }\n        default: {\n          document.dispatchEvent(editorEmittedEvent('close'))\n          suggestionList.clear()\n          return next()\n        }\n      }\n    } else {\n      return next()\n    }\n  }\n\n  const onMouseDown = (e, editor, next) => {\n    document.dispatchEvent(editorEmittedEvent('close'))\n    return next()\n  }\n\n  return ({ onKeyDown, onMouseDown })\n}\n\nconst SuggestionPortalPlugin = ({\n  ...LastWordPlugin,\n  ...EventDispatcher(),\n  renderEditor: (props, editor, next) => (\n    <>\n      {next()}\n      <Portal editor={editor} />\n    </>\n  )\n})\n\nexport default SuggestionPortalPlugin\n","import React from 'react'\nimport styleQueryPlugin from './styleQueryPlugin'\n\nconst toolbarStyle = {\n  display: 'flex',\n  justifyContent: 'space-between'\n}\nconst moduleStyle = {}\n\nconst buttonStyle = ({ active }) => ({\n  margin: '10px 5px',\n  backgroundColor: active ? 'gray' : 'transparent',\n  color: active ? 'white' : 'black',\n  fontFamily: 'source-code-pro, Menlo, Monaco, Consolas, \"Courier New\",monospace',\n  fontWeight: 'bold',\n  padding: '5px',\n  border: 0,\n  cursor: 'pointer'\n})\n\nconst makeButton = ({ mouseDownHandler, styleHandler }) => ({ editor, label }) => (\n  <button\n    style={styleHandler(editor)}\n    onMouseDown={mouseDownHandler(editor)}\n  >\n    {label}\n  </button>\n)\nconst makeToggleMarkButton = ({ type }) => makeButton({\n  mouseDownHandler: editor => e => {\n    e.preventDefault()\n    editor.toggleMark({ type })\n  },\n  styleHandler: editor => editor.isMarkTypeActive(type)\n    ? buttonStyle({ active: true })\n    : buttonStyle({ active: false })\n})\nconst ToggleMarkButton = ({ type, label, editor }) => (\n  makeToggleMarkButton({ type })({ editor, label })\n)\n\nconst makeSetBlockButton = ({ type }) => makeButton({\n  mouseDownHandler: editor => e => {\n    e.preventDefault()\n    editor.setBlocks({ type })\n  },\n  styleHandler: editor => editor.isBlockTypeActive(type)\n    ? buttonStyle({ active: true })\n    : buttonStyle({ active: false })\n})\nconst SetBlockButton = ({ type, label, editor }) => (\n  makeSetBlockButton({ type })({ editor, label })\n)\n\nconst Toolbar = ({ editor }) => (\n  <div style={toolbarStyle}>\n    <div style={moduleStyle}>\n      <ToggleMarkButton\n        editor={editor}\n        type='bold'\n        label='Bold'\n      />\n      <ToggleMarkButton\n        editor={editor}\n        type='italic'\n        label='Italic'\n      />\n      <ToggleMarkButton\n        editor={editor}\n        type='strikethrough'\n        label='Strike'\n      />\n    </div>\n    <div style={moduleStyle}>\n      <SetBlockButton\n        editor={editor}\n        type='paragraph'\n        label='Para...'\n      />\n      <SetBlockButton\n        editor={editor}\n        type='quotation'\n        label='Qua.'\n      />\n      <SetBlockButton\n        editor={editor}\n        type='code'\n        label='<code>'\n      />\n    </div>\n  </div>\n)\n\nconst ToolbarPlugin = {\n  renderEditor: (props, editor, next) => {\n    return (\n      <>\n        <Toolbar editor={editor} />\n        {next()}\n      </>\n    )\n  },\n  ...styleQueryPlugin\n}\n\nexport default ToolbarPlugin\n","\nconst styleQueryPlugin = {\n  queries: {\n    isBoldActive: editor => editor.value.activeMarks.some(mark => mark.type === 'bold'),\n    isItalicActive: editor => editor.value.activeMarks.some(mark => mark.type === 'italic'),\n    isStrikethroughActive: editor => editor.value.activeMarks.some(mark => mark.type === 'strikethrough'),\n    isMarkTypeActive: (editor, type) => editor.value.activeMarks.some(mark => mark.type === type),\n    isCodeBlock: editor => editor.value.blocks.some(block => block.type === 'code'),\n    isParagraphBlock: editor => editor.value.blocks.some(block => block.type === 'paragraph'),\n    isQuotationBlock: editor => editor.value.blocks.some(block => block.type === 'quotation'),\n    isBlockTypeActive: (editor, type) => editor.value.blocks.some(block => block.type === type)\n  }\n}\n\nexport default styleQueryPlugin\n","import React from 'react'\n\nconst style = {\n  padding: '5px',\n  textAlign: 'right',\n  color: 'gray',\n  fontFamily: `source-code-pro, Menlo, Monaco, Consolas, \"Courier New\",\n  monospace`,\n  fontWeight: 'bold'\n}\n\nconst calLength = str => str.split(' ').join('').split('\\n').join('').length\n\nconst TextCountPlugin = {\n  renderEditor: (props, editor, next) => {\n    const totalText = calLength(editor.value.document.text)\n    const selectedText = calLength(editor.value.fragment.text)\n    return (\n      <>\n        {next()}\n        <div style={style}>\n          <span>{selectedText} sel.</span>\n          <span>{totalText} tot.</span>\n        </div>\n      </>\n    )\n  }\n}\n\nexport default TextCountPlugin\n","import React from 'react'\n\nconst EditorStylePlugin = style => ({\n  renderEditor: (props, editor, next) => {\n    return (\n      <div style={style}>\n        {next()}\n      </div>\n    )\n  }\n})\n\nexport default EditorStylePlugin\n","import store from 'store-js'\nimport { Value } from 'slate'\n\nconst importer = () => {\n  const storedJsonStr = store.get('slateJs-demo')\n  const json = storedJsonStr ? JSON.parse(storedJsonStr) : ''\n  const initialValue = Value.fromJSON(json || {\n    document: {\n      nodes: [\n        {\n          object: 'block',\n          type: 'paragraph',\n          nodes: [\n            {\n              object: 'text',\n              text: ' A line of text in a paragraph.'\n            }\n          ]\n        }\n      ]\n    }\n  })\n  return initialValue\n}\n\nconst exporter = change => {\n  const jsonStr = JSON.stringify(change.value.toJSON())\n  store.set('slateJs-demo', jsonStr)\n}\n\nexport default { importer, exporter }\n","// core\nimport React from 'react'\nimport { Editor } from 'slate-react'\n\n// plugins\n/* ------ KeyBinding ------- */\nimport CmdKeyPlugins from './plugins/CmdKeyPlugins'\nimport CtrlKeyPlugins from './plugins/CtrlKeyPlugins'\nimport TabIndentPlugin from './plugins/TabIndentPlugin'\n\n/* ------ Decoration ------- */\nimport HighlightFocusedBlockPlugin from './plugins/HighlightFocusedBlockPlugin'\n\n/* ------ Suggestion ------- */\nimport SuggestionPortalPlugin from './plugins/SuggestionPortalPlugin'\n\n/* ---------  GUI  --------- */\nimport ToolbarPlugin from './plugins/ToolbarPlugin'\nimport TextCountPlugin from './plugins/TextCountPlugin'\n\n/* --------- Style -------- */\nimport EditorStylePlugin from './plugins/EditorStylePlugin'\n\n// save & load\nimport EditorContentAPI from './api/EditorContentAPI'\n\nconst plugins = [\n  HighlightFocusedBlockPlugin('rgba(0,0,0,.1)'),\n  ...CmdKeyPlugins,\n  ...CtrlKeyPlugins,\n  TabIndentPlugin,\n  ToolbarPlugin,\n  TextCountPlugin,\n  SuggestionPortalPlugin,\n  EditorStylePlugin({\n    border: '1px solid lightgray',\n    padding: '7px'\n  })\n]\n\nconst H2oEditor = props => {\n  // fetch EditorContent\n  React.useEffect(\n    () => {\n      const initVal = EditorContentAPI.importer()\n      setValue(initVal)\n    }, []\n  )\n\n  const [value, setValue] = React.useState(null)\n\n  const onChange = change => {\n    // export EditorContent when substantial change occurs\n    if (change.value.document !== value.document) {\n      EditorContentAPI.exporter(change)\n    }\n\n    // update editor\n    setValue(change.value)\n  }\n\n  return value ? (\n    <Editor\n      onChange={onChange}\n      value={value}\n      plugins={plugins}\n      autoFocus\n    />\n  ) : null\n}\n\nexport default H2oEditor\n","export default {\n  onKeyDown: (e, editor, next) => {\n    if (e.keyCode !== 9) {\n      return next()\n    }\n    e.preventDefault()\n    editor.insertText('    ')\n  }\n}\n","import React from 'react'\nimport SuggestionMapAPI from './api/SuggestionMapAPI'\n\nconst tableStyle = {\n  display: 'flex',\n  flexFlow: 'row nowrap',\n  margin: '10px -10px'\n}\nconst pairStyle = {\n  display: 'flex',\n  flexFlow: 'row',\n  margin: '10px'\n}\nconst inputStyle = type => ({\n  width: type === 'key' ? '100px' : '200px',\n  textAlign: 'center',\n  padding: '7px',\n  margin: '3px',\n  fontFamily: 'source-code-pro, Menlo, Monaco, Consolas, \"Courier New\",monospace',\n  fontWeight: 'bold',\n  border: '0',\n  borderBottom: '1px solid gray',\n  outline: 'none'\n})\nconst buttonStyle = {\n  margin: '10px 5px',\n  fontFamily: 'source-code-pro, Menlo, Monaco, Consolas, \"Courier New\",monospace',\n  fontWeight: 'bold',\n  padding: '5px',\n  border: 0,\n  cursor: 'pointer'\n}\nconst deleteButtonStyle = {\n  backgroundColor: 'transparent',\n  border: '0',\n  color: 'indianRed',\n  cursor: 'pointer'\n\n}\n\nconst Input = ({ value, setState, style }) => {\n  const [v, setV] = React.useState(value)\n  const inputRef = React.useRef()\n\n  const onChange = e => setV(e.target.value)\n  const onFocus = e => inputRef.current.select()\n  const onBlur = e => value === v ? 0 : setState(v)\n\n  return (\n    <input\n      style={style}\n      ref={inputRef}\n      value={v}\n      onChange={onChange}\n      onFocus={onFocus}\n      onBlur={onBlur}\n    />\n  )\n}\n\nconst KeyMapTable = () => {\n  // fetch keyMapTable\n  React.useEffect(\n    () => {\n      const table = SuggestionMapAPI.importer()\n      setKeys(Object.keys(table))\n      setVals(Object.keys(table).map(key => table[key]))\n      setUids(Object.keys(table).map((key, i) => i))\n      setNextId(Object.keys(table).length)\n    }, []\n  )\n\n  // flatten table to keys[] : vals[] pair\n  const [keys, setKeys] = React.useState([])\n  const [vals, setVals] = React.useState([])\n  // dynamic generate unique keyId for new pair\n  const [uids, setUids] = React.useState([])\n  const [nextId, setNextId] = React.useState(0)\n\n  const setStateBy = (index, field, setter) => newVal => {\n    setter([...field.slice(0, index), newVal, ...field.slice(index + 1)])\n  }\n\n  const deletePair = index => e => {\n    setKeys([...keys.slice(0, index), ...keys.slice(index + 1)])\n    setVals([...vals.slice(0, index), ...vals.slice(index + 1)])\n    setUids([...uids.slice(0, index), ...uids.slice(index + 1)])\n  }\n\n  const addPair = () => {\n    setKeys(['', ...keys])\n    setVals(['', ...vals])\n    setUids([nextId, ...uids])\n    setNextId(nextId + 1)\n  }\n\n  // bind keys[] : vals[] pair to generate suggestion table\n  const bind = (keys, vals) => keys.reduce(\n    (acc, key, i) => (\n      key ? { ...acc, [key]: vals[i] } : { ...acc }\n    ), {}\n  )\n  const exportData = () => {\n    SuggestionMapAPI.exporter(bind(keys, vals))\n    document.dispatchEvent(new window.CustomEvent('suggestionMapUpdated'))\n  }\n\n  React.useEffect(\n    () => {\n      exportData()\n    }\n  )\n\n  return (\n    <div>\n      <div style={{ display: 'flex', justifyContent: 'flex-start' }}>\n        <button onClick={addPair} style={buttonStyle}>+ add new shortcut</button>\n      </div>\n      <div style={tableStyle}>\n        {uids.map(\n          (uid, i) => (\n            <div key={uid} style={pairStyle}>\n              <button\n                style={deleteButtonStyle}\n                onClick={deletePair(i)}\n              >-\n              </button>\n              <Input\n                style={inputStyle('key')}\n                value={keys[i]}\n                setState={setStateBy(i, keys, setKeys)}\n              />\n              <Input\n                style={inputStyle('val')}\n                value={vals[i]}\n                setState={setStateBy(i, vals, setVals)}\n              />\n            </div>\n          )\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default KeyMapTable\n","import React from 'react'\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link\n} from 'react-router-dom'\nimport Editor from './editor/Editor.js'\nimport KeyMapTable from './editor/KeyMapTable'\nimport { Divider } from '@material-ui/core'\n\nfunction App () {\n  return (\n    <>\n      <div style={{\n        padding: '30px'\n      }}\n      >\n        <Editor />\n      </div>\n      <Divider />\n      <div style={{\n        padding: '30px'\n      }}\n      >\n        <KeyMapTable />\n      </div>\n    </>\n  )\n}\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}